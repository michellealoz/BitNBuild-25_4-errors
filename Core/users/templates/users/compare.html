{% extends 'users/base.html' %}

{% block title %}Compare Products - Review Radar{% endblock %}

{% block page_title %}Compare Products{% endblock %}
{% block page_subtitle %}Enter two Amazon product URLs to see a side-by-side comparison.{% endblock %}

{% block content %}
<form method="post">
    {% csrf_token %}
    <div class="app-card mb-6 p-6">
        <div class="card-body">
            <div style="display: flex; gap: 1rem; align-items: center; margin-bottom: 1rem;">
                <div style="flex: 1;">
                    <input type="url" name="product_url_1" class="form-input" 
                           placeholder="https://www.amazon.in/dp/PRODUCT_ID1" 
                           value="{{ product_url_1|default:'' }}" required>
                </div>
                <div style="text-align: center;">
                    <span style="font-weight: bold; font-size: 1.25rem; color: #9CA3AF;">VS</span>
                </div>
                <div style="flex: 1;">
                    <input type="url" name="product_url_2" class="form-input" 
                           placeholder="https://www.amazon.in/dp/PRODUCT_ID2" 
                           value="{{ product_url_2|default:'' }}" required>
                </div>
            </div>
            <div class="text-center mt-4">
                <button class="btn-primary px-8 py-3 text-lg" type="submit">
                    <i class="fas fa-balance-scale me-2"></i>Compare Products
                </button>
            </div>
        </div>
    </div>
</form>
<!-- Add this line to create more space -->
<div style="margin-bottom: 3rem;"></div>
{% if error %}
<div class="alert alert-error mb-6" role="alert">
    <i class="fas fa-exclamation-triangle me-2"></i><strong>Error:</strong> {{ error }}
</div>
{% endif %}

{% if data1 and data2 %}
<!-- Comparison Results -->
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
    <!-- Product 1 -->
    <div class="app-card" style="border: {% if data1.overall_score > data2.overall_score %}2px solid #9ae49a{% else %}1px solid #4A90E2{% endif %};">
        <div style="padding: 1rem; background: {% if data1.overall_score > data2.overall_score %}#9ae49a{% else %}#4A90E2{% endif %}; color: {% if data1.overall_score > data2.overall_score %}#000000{% else %}#ffffff{% endif %}; font-weight: bold; border-radius: 0.5rem 0.5rem 0 0;">
            <i class="fas fa-box me-2"></i>Product A
            {% if data1.overall_score > data2.overall_score %}
            <span style="float: right; background: #f8c050; color: #000000; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.875rem;">WINNER</span>
            {% endif %}
        </div>
        <div style="padding: 1.5rem;">
            <h5 style="font-size: 1.25rem; font-weight: bold; color: white; margin-bottom: 1rem;">{{ data1.product_name|truncatechars:50 }}</h5>
            
            <!-- Scores -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; text-align: center; margin-bottom: 1.5rem;">
                <div>
                    <div style="font-size: 2.25rem; font-weight: bold; color: #4A90E2;">{{ data1.overall_score }}/10</div>
                    <small style="color: #9CA3AF;">Overall Score</small>
                </div>
                <div>
                    <div style="font-size: 1.5rem; font-weight: bold; color: #9ae49a;">{{ data1.public_opinion.average_rating }}/5</div>
                    <small style="color: #9CA3AF;">Average Rating</small>
                </div>
            </div>

            <!-- Price and Sentiment Info -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                <div>
                    <div style="color: #9CA3AF; font-size: 0.875rem;">Price:</div>
                    <div style="font-weight: bold; color: white; font-size: 1.125rem;">₹{{ data1.price|default:"Not available" }}</div>
                </div>
                <div>
                    <div style="color: #9CA3AF; font-size: 0.875rem;">Positive Sentiment:</div>
                    <div style="width: 100%; background: #374151; border-radius: 9999px; height: 0.5rem; margin-bottom: 0.25rem;">
                        <div style="background: #9ae49a; height: 0.5rem; border-radius: 9999px; width: {{ data1.public_opinion.positive_percent }}%;"></div>
                    </div>
                    <div style="color: #9ae49a; font-size: 0.875rem;">{{ data1.public_opinion.positive_percent }}%</div>
                </div>
            </div>

            <!-- Strengths -->
            <div style="margin-top: 1.5rem;">
                <h6 style="color: #9ae49a; font-weight: bold; margin-bottom: 0.75rem;"><i class="fas fa-thumbs-up me-2"></i> Strengths:</h6>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    {% for pro in data1.pros_cons_panel.pros %}
                    <li style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                        <i class="fas fa-check text-neon-green me-3" style="color: #9ae49a;"></i>
                        <span style="color: white;">{{ pro|title }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>

            <!-- Concerns -->
            <div style="margin-top: 1rem;">
                <h6 style="color: #f87171; font-weight: bold; margin-bottom: 0.75rem;"><i class="fas fa-thumbs-down me-2"></i> Concerns:</h6>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    {% for con in data1.pros_cons_panel.cons %}
                    <li style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                        <i class="fas fa-times me-3" style="color: #f87171;"></i>
                        <span style="color: white;">{{ con|title }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <!-- Product 2 -->
    <div class="app-card" style="border: {% if data2.overall_score > data1.overall_score %}2px solid #9ae49a{% else %}1px solid #4A90E2{% endif %};">
        <div style="padding: 1rem; background: {% if data2.overall_score > data1.overall_score %}#9ae49a{% else %}#4A90E2{% endif %}; color: {% if data2.overall_score > data1.overall_score %}#000000{% else %}#ffffff{% endif %}; font-weight: bold; border-radius: 0.5rem 0.5rem 0 0;">
            <i class="fas fa-box me-2"></i>Product B
            {% if data2.overall_score > data1.overall_score %}
            <span style="float: right; background: #f8c050; color: #000000; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.875rem;">WINNER</span>
            {% endif %}
        </div>
        <div style="padding: 1.5rem;">
            <h5 style="font-size: 1.25rem; font-weight: bold; color: white; margin-bottom: 1rem;">{{ data2.product_name|truncatechars:50 }}</h5>
            
            <!-- Scores -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; text-align: center; margin-bottom: 1.5rem;">
                <div>
                    <div style="font-size: 2.25rem; font-weight: bold; color: #4A90E2;">{{ data2.overall_score }}/10</div>
                    <small style="color: #9CA3AF;">Overall Score</small>
                </div>
                <div>
                    <div style="font-size: 1.5rem; font-weight: bold; color: #9ae49a;">{{ data2.public_opinion.average_rating }}/5</div>
                    <small style="color: #9CA3AF;">Average Rating</small>
                </div>
            </div>

            <!-- Price and Sentiment Info -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                <div>
                    <div style="color: #9CA3AF; font-size: 0.875rem;">Price:</div>
                    <div style="font-weight: bold; color: white; font-size: 1.125rem;">₹{{ data2.price|default:"Not available" }}</div>
                </div>
                <div>
                    <div style="color: #9CA3AF; font-size: 0.875rem;">Positive Sentiment:</div>
                    <div style="width: 100%; background: #374151; border-radius: 9999px; height: 0.5rem; margin-bottom: 0.25rem;">
                        <div style="background: #9ae49a; height: 0.5rem; border-radius: 9999px; width: {{ data2.public_opinion.positive_percent }}%;"></div>
                    </div>
                    <div style="color: #9ae49a; font-size: 0.875rem;">{{ data2.public_opinion.positive_percent }}%</div>
                </div>
            </div>

            <!-- Strengths -->
            <div style="margin-top: 1.5rem;">
                <h6 style="color: #9ae49a; font-weight: bold; margin-bottom: 0.75rem;"><i class="fas fa-thumbs-up me-2"></i> Strengths:</h6>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    {% for pro in data2.pros_cons_panel.pros %}
                    <li style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                        <i class="fas fa-check text-neon-green me-3" style="color: #9ae49a;"></i>
                        <span style="color: white;">{{ pro|title }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>

            <!-- Concerns -->
            <div style="margin-top: 1rem;">
                <h6 style="color: #f87171; font-weight: bold; margin-bottom: 0.75rem;"><i class="fas fa-thumbs-down me-2"></i> Concerns:</h6>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    {% for con in data2.pros_cons_panel.cons %}
                    <li style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                        <i class="fas fa-times me-3" style="color: #f87171;"></i>
                        <span style="color: white;">{{ con|title }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Quick Comparison Summary -->
<div class="app-card">
    <div style="padding: 1rem; background: #374151; border-radius: 0.5rem 0.5rem 0 0;">
        <h6 style="margin-bottom: 0; color: white; font-weight: bold;"><i class="fas fa-chart-bar me-2"></i>Quick Comparison</h6>
    </div>
    <div style="padding: 1.5rem;">
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; text-align: center;">
            <div>
                <div style="font-size: 1.5rem; font-weight: bold; {% if data1.overall_score > data2.overall_score %}color: #9ae49a{% else %}color: white{% endif %};">
                    {{ data1.overall_score }}
                </div>
                <small style="color: #9CA3AF;">Product A Score</small>
            </div>
            <div>
                <div style="font-size: 1.25rem; color: #9CA3AF;">VS</div>
                <small style="color: #9CA3AF;">Comparison</small>
            </div>
            <div>
                <div style="font-size: 1.5rem; font-weight: bold; {% if data2.overall_score > data1.overall_score %}color: #9ae49a{% else %}color: white{% endif %};">
                    {{ data2.overall_score }}
                </div>
                <small style="color: #9CA3AF;">Product B Score</small>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}